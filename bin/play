#!/usr/bin/env node

var through = require('through2');
var util = require('../util.js');

var Env = require('../env.js');

var News = require('../sources/news/index.js')();
var OurRISD = require('../sources/our-risd/index.js')();

var tags = [];
var count = 0;
News.listSource()
// OurRISD.listSource();
	.pipe(through.obj(log));

function log (row, enc, next) {
	if (row.Title === undefined) {
		console.log(row);
	}
	this.push(row);
	next();
}

function counter (row, enc, next) {
	count += 1;
	next();
}

function logend () {
	console.log(count + ' items.');
}

function add (row, enc, next) {
	if (tags.indexOf(row.tags[0]) === -1) {
		tags.push(row.tags[0]);
	}
	next();
}

function done () {
	console.log(tags);
}

// function Related () {
// 	return through.obj()
// }